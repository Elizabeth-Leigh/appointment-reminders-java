<!DOCTYPE html><html><head><title>Appointment Reminders</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Appointment Reminders"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Appointment Reminders</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement appointment reminders in your web app with Twilio. Appointment reminders allow you to automate the process of reaching out to your customers in advance of an upcoming appointment.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Appointment Reminders" class="chapter"><div data-file="src/main/java/com/twilio/appointmentreminders/Server.java" class="step"><h2 id="about-this-application">About this application</h2>
<p>This is a Java 8 web application written using <a href="http://sparkjava.com/">Spark</a>
that demonstrates how to send appointment reminders to your customers with
Twilio SMS.</p>
<p>Check out <a href="https://github.com/TwilioDevEd/appointment-reminders-java">this application on GitHub</a>
to download the code and read instructions on how to run it yourself. In
this tutorial, we&#39;ll show you the key bits of code necessary to drive this
use case.</p>
<p>Let&#39;s get started! Click the right arow above to advance the tutorial.</p>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="https://www.twilio.com/docs/java/install">The Twilio Java Helper Library</a></li>
<li><a href="http://sparkjava.com/">Spark micro framework</a></li>
<li><a href="http://www.eclipse.org/eclipselink/">EclipseLink</a></li>
<li><a href="http://sparkjava.com/documentation.html#views-templates">Spark&#39;s compatible templating engines</a></li>
<li><a href="http://junit.org/">JUnit</a></li>
<li><a href="http://www.joda.org/joda-time/">Joda-Time</a></li>
<li><a href="http://quartz-scheduler.org/">Quartz Job Scheduler</a></li>
<li><a href="http://flywaydb.org/">Flyway DB Migrations</a></li>
</ul>
</div><div data-file="src/main/java/com/twilio/appointmentreminders/Server.java" data-highlight="42-51" class="step"><h2 id="create-the-quartz-job-scheduler">Create the Quartz job scheduler</h2>
<p>The Quartz scheduler is instantiated in the main method of our web
application, before we set up the <a href="http://sparkjava.com/documentation.html#routes">routes</a>.
We pass a reference to this scheduler to the controller so it can schedule
jobs to send out appointment reminders. Note that by default, Quartz temporarily
stores jobs in memory, but in production you can configure Quartz to store
jobs in a data store of your choice.</p>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="https://github.com/TwilioDevEd/appointment-reminders-java/blob/
master/src/main/resources/META-INF/quartz.properties">Quartz Configuration File</a></li>
<li><a href="http://quartz-scheduler.org/documentation">Quartz Documentation</a></li>
</ul>
</div><div data-file="src/main/java/com/twilio/appointmentreminders/controllers/AppointmentController.java" data-highlight="69-111" class="step"><h2 id="create-an-appointment">Create an appointment</h2>
<p>This is how a new appointment is created. Once validations pass and the appointment is persisted
to the database, a notification is scheduled based on the time of the appointment.</p>
</div><div data-file="src/main/java/com/twilio/appointmentreminders/controllers/AppointmentController.java" data-highlight="113-140" class="step"><h2 id="schedule-the-reminder-job">Schedule the reminder job</h2>
<p>The controller uses the injected scheduler to set up a notification. The 
<code>AppointmentScheduler</code> class is used here to actually send out the notification
via SMS.</p>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="http://quartz-scheduler.org/generated/2.2.1/html/qs-all/#page/
Quartz_Scheduler_Documentation_Set%2Fco-trg_simple_triggers.html%23">Quartz Triggers</a></li>
</ul>
</div><div data-file="src/main/java/com/twilio/appointmentreminders/util/AppointmentScheduler.java" data-highlight="21-25" class="step"><h2 id="configure-the-application-to-send-sms-messages">Configure the application to send SMS messages</h2>
<p>Every time a scheduled job is triggered by Quartz, an instance of the
<code>AppointmentScheduler</code> class is created to handle the job. When the class is
loaded, we create a <code>RestClient</code> to interact with the Twilio API using our 
account credentials.</p>
<h4 id="see-also">See Also</h4>
<ul>
<li><a href="https://www.twilio.com/docs/java/install">The Twilio Java Helper Library</a></li>
</ul>
</div><div data-file="src/main/java/com/twilio/appointmentreminders/util/AppointmentScheduler.java" data-highlight="43-61" class="step"><h2 id="send-an-sms-message-from-a-background-job">Send an SMS message from a background job</h2>
<p>When the <code>execute</code> method is called on an <code>AppointmentScheduler</code> instance,
we use the Twilio REST API client to actually send a formatted reminder
message to our customer via SMS.</p>
<h4 id="see-also">See Also</h4>
<ul>
<li><a href="//www.twilio.com/docs/api/rest/sending-messages">API Reference: Sending SMS</a></li>
</ul>
</div><div class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! We&#39;ve successfully set up automated appointment reminders for our
customers, which will be delivered via SMS. If you haven&#39;t already, be sure 
to check out the <a href="http://twilio.github.io/twilio-java/">JavaDoc for the Twilio helper library</a> 
and our guides for <a href="//www.twilio.com/docs/guides/sms/sending/java">SMS</a>
and <a href="//www.twilio.com/docs/guides/voice/make-outgoing-phone-calls/java">voice</a>.</p>
<p><strong>Did this help?</strong></p>
<p>Thanks for checking out this tutorial! If you have any feedback
to share with us, we&#39;d love to hear it.
<a href="mailto:deved-oss@twilio.com">Contact the Twilio Developer Education Team</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/Server.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzOwoKaW1wb3J0IGNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMuY29udHJvbGxlcnMuQXBwb2ludG1lbnRDb250cm9sbGVyOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnRTZXJ2aWNlOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkFwcFNldHVwOwppbXBvcnQgb3JnLnF1YXJ0ei5TY2hlZHVsZXI7CmltcG9ydCBvcmcucXVhcnR6LlNjaGVkdWxlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5xdWFydHouaW1wbC5TdGRTY2hlZHVsZXJGYWN0b3J5OwppbXBvcnQgc3BhcmsuU3Bhcms7CmltcG9ydCBzcGFyay50ZW1wbGF0ZS5tdXN0YWNoZS5NdXN0YWNoZVRlbXBsYXRlRW5naW5lOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwoKaW1wb3J0IHN0YXRpYyBzcGFyay5TcGFyay4qOwoKLyoqCiAqIE1haW4gYXBwbGljYXRpb24gY2xhc3MuIFRoZSBlbnZpcm9ubWVudCBpcyBzZXQgdXAgaGVyZSwgYW5kIGFsbCBuZWNlc3Nhcnkgc2VydmljZXMgYXJlIHJ1bi4KICovCnB1YmxpYyBjbGFzcyBTZXJ2ZXIgewogIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgIEFwcFNldHVwIGFwcFNldHVwID0gbmV3IEFwcFNldHVwKCk7CgogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBwb3J0IGluIHdoaWNoIHRoZSBhcHBsaWNhdGlvbiB3aWxsIHJ1bi4gVGFrZXMgdGhlIHBvcnQgdmFsdWUgZnJvbSBQT1JUCiAgICAgKiBlbnZpcm9ubWVudCB2YXJpYWJsZSwgaWYgbm90IHNldCwgdXNlcyBTcGFyayBkZWZhdWx0IHBvcnQgNDU2Ny4KICAgICAqLwogICAgcG9ydChhcHBTZXR1cC5nZXRQb3J0TnVtYmVyKCkpOwoKICAgIC8qKgogICAgICogR2V0cyB0aGUgZW50aXR5IG1hbmFnZXIgYmFzZWQgb24gZW52aXJvbm1lbnQgdmFyaWFibGUgREFUQUJBU0VfVVJMIGFuZCBpbmplY3RzIGl0IGludG8KICAgICAqIEFwcG9pbnRtZW50U2VydmljZSB3aGljaCBoYW5kbGVzIGFsbCBEQiBvcGVyYXRpb25zLgogICAgICovCiAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0gYXBwU2V0dXAuZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKTsKICAgIEFwcG9pbnRtZW50U2VydmljZSBzZXJ2aWNlID0gbmV3IEFwcG9pbnRtZW50U2VydmljZShmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKSk7CgogICAgLyoqCiAgICAgKiBTcGVjaWZpZXMgdGhlIGRpcmVjdG9yeSB3aXRoaW4gcmVzb3VyY2VzIHRoYXQgd2lsbCBiZSBwdWJsaWNseSBhdmFpbGFibGUgd2hlbiB0aGUKICAgICAqIGFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcuIFBsYWNlIHN0YXRpYyB3ZWIgZmlsZXMgaW4gdGhpcyBkaXJlY3RvcnkgKEpTLCBDU1MpLgogICAgICovCiAgICBTcGFyay5zdGF0aWNGaWxlTG9jYXRpb24oIi9wdWJsaWMiKTsKCiAgICAvKiogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiBRdWFydHogU2NoZWR1bGVyIGFuZCBzdGFydHMgaXQuICovCiAgICBTY2hlZHVsZXIgc2NoZWR1bGVyID0gbnVsbDsKICAgIHRyeSB7CiAgICAgIHNjaGVkdWxlciA9IFN0ZFNjaGVkdWxlckZhY3RvcnkuZ2V0RGVmYXVsdFNjaGVkdWxlcigpOwoKICAgICAgc2NoZWR1bGVyLnN0YXJ0KCk7CgogICAgfSBjYXRjaCAoU2NoZWR1bGVyRXhjZXB0aW9uIHNlKSB7CiAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiVW5hYmxlIHRvIHN0YXJ0IHNjaGVkdWxlciBzZXJ2aWNlIik7CiAgICB9CgogICAgLyoqIEluamVjdHMgQXBwb2ludG1lbnRTZXJ2aWNlIGFuZCBTY2hlZHVsZXIgaW50byB0aGUgY29udHJvbGxlci4gKi8KICAgIEFwcG9pbnRtZW50Q29udHJvbGxlciBjb250cm9sbGVyID0gbmV3IEFwcG9pbnRtZW50Q29udHJvbGxlcihzZXJ2aWNlLCBzY2hlZHVsZXIpOwoKICAgIC8qKgogICAgICogRGVmaW5lcyBhbGwgdXJsIHBhdGhzIGZvciB0aGUgYXBwbGljYXRpb24gYW5kIGFzc2lnbnMgYSBjb250cm9sbGVyIG1ldGhvZCBmb3IgZWFjaC4KICAgICAqIElmIHRoZSByb3V0ZSByZW5kZXJzIGEgcGFnZSwgdGhlIHRlbXBsYXRpbmcgZW5naW5lIG11c3QgYmUgc3BlY2lmaWVkLCBhbmQgdGhlIGNvbnRyb2xsZXIKICAgICAqIHNob3VsZCByZXR1cm4gdGhlIGFwcHJvcHJpYXRlIFJvdXRlIG9iamVjdC4KICAgICAqLwogICAgZ2V0KCIvIiwgY29udHJvbGxlci5pbmRleCwgbmV3IE11c3RhY2hlVGVtcGxhdGVFbmdpbmUoKSk7CiAgICBnZXQoIi9uZXciLCBjb250cm9sbGVyLnJlbmRlckNyZWF0ZVBhZ2UsIG5ldyBNdXN0YWNoZVRlbXBsYXRlRW5naW5lKCkpOwogICAgcG9zdCgiL2NyZWF0ZSIsIGNvbnRyb2xsZXIuY3JlYXRlLCBuZXcgTXVzdGFjaGVUZW1wbGF0ZUVuZ2luZSgpKTsKICAgIHBvc3QoIi9kZWxldGUiLCBjb250cm9sbGVyLmRlbGV0ZSk7CiAgfQp9Cg==</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/controllers/AppointmentController.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLmNvbnRyb2xsZXJzOwoKaW1wb3J0IGNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMubW9kZWxzLkFwcG9pbnRtZW50OwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnRTZXJ2aWNlOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkFwcG9pbnRtZW50U2NoZWR1bGVyOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkZpZWxkVmFsaWRhdG9yOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLlRpbWVab25lczsKaW1wb3J0IG9yZy5qb2RhLnRpbWUuRGF0ZVRpbWU7CmltcG9ydCBvcmcuam9kYS50aW1lLkRhdGVUaW1lWm9uZTsKaW1wb3J0IG9yZy5qb2RhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0OwppbXBvcnQgb3JnLmpvZGEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7CmltcG9ydCBvcmcucXVhcnR6LkpvYkRldGFpbDsKaW1wb3J0IG9yZy5xdWFydHouU2NoZWR1bGVyOwppbXBvcnQgb3JnLnF1YXJ0ei5TY2hlZHVsZXJFeGNlcHRpb247CmltcG9ydCBvcmcucXVhcnR6LlRyaWdnZXI7CmltcG9ydCBzcGFyay5Nb2RlbEFuZFZpZXc7CmltcG9ydCBzcGFyay5Sb3V0ZTsKaW1wb3J0IHNwYXJrLlRlbXBsYXRlVmlld1JvdXRlOwoKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgc3RhdGljIG9yZy5xdWFydHouSm9iQnVpbGRlci5uZXdKb2I7CmltcG9ydCBzdGF0aWMgb3JnLnF1YXJ0ei5UcmlnZ2VyQnVpbGRlci5uZXdUcmlnZ2VyOwoKLyoqCiAqIEFwcG9pbnRtZW50IGNvbnRyb2xsZXIgY2xhc3MuIEhvbGRzIGFsbCB0aGUgbWV0aG9kcyB0aGF0IGhhbmRsZSB0aGUgYXBwbGljYXRpb25zIHJlcXVlc3RzLgogKiBUaGlzIG1ldGhvZHMgYXJlIG1hcHBlZCB0byBhIHNwZWNpZmljIFVSTCBvbiB0aGUgbWFpbiBTZXJ2ZXIgZmlsZSBvZiB0aGUgYXBwbGljYXRpb24uCiAqLwpAU3VwcHJlc3NXYXJuaW5ncyh7InJhd3R5cGVzIiwgInVuY2hlY2tlZCJ9KQpwdWJsaWMgY2xhc3MgQXBwb2ludG1lbnRDb250cm9sbGVyIHsKICBwcml2YXRlIFNjaGVkdWxlciBzY2hlZHVsZXI7CiAgcHJpdmF0ZSBBcHBvaW50bWVudFNlcnZpY2Ugc2VydmljZTsKCiAgcHVibGljIEFwcG9pbnRtZW50Q29udHJvbGxlcihBcHBvaW50bWVudFNlcnZpY2Ugc2VydmljZSwgU2NoZWR1bGVyIHNjaGVkdWxlcikgewogICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTsKICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogIH0KCiAgcHVibGljIFRlbXBsYXRlVmlld1JvdXRlIHJlbmRlckNyZWF0ZVBhZ2UgPSAocmVxdWVzdCwgcmVzcG9uc2UpIC0+IHsKICAgIE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgpOwoKICAgIG1hcC5wdXQoInpvbmVzIiwgdGltZVpvbmVzKCkpOwogICAgcmV0dXJuIG5ldyBNb2RlbEFuZFZpZXcobWFwLCAibmV3Lm11c3RhY2hlIik7CiAgfTsKCiAgcHVibGljIFRlbXBsYXRlVmlld1JvdXRlIGluZGV4ID0gKHJlcXVlc3QsIHJlc3BvbnNlKSAtPiB7CiAgICBNYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsKCiAgICBMaXN0PEFwcG9pbnRtZW50PiBhcHBvaW50bWVudHMgPSBzZXJ2aWNlLmZpbmRBbGwoKTsKICAgIG1hcC5wdXQoImFwcG9pbnRtZW50cyIsIGFwcG9pbnRtZW50cyk7CgogICAgcmV0dXJuIG5ldyBNb2RlbEFuZFZpZXcobWFwLCAiaW5kZXgubXVzdGFjaGUiKTsKICB9OwoKICBwdWJsaWMgUm91dGUgZGVsZXRlID0gKHJlcXVlc3QsIHJlc3BvbnNlKSAtPiB7CiAgICBTdHJpbmcgaWQgPSByZXF1ZXN0LnF1ZXJ5UGFyYW1zKCJpZCIpOwogICAgTG9uZyBpZExvbmcgPSBMb25nLnBhcnNlTG9uZyhpZCwgMTApOwoKICAgIEFwcG9pbnRtZW50IGFwcG9pbnRtZW50ID0gc2VydmljZS5nZXRBcHBvaW50bWVudChpZExvbmcpOwogICAgc2VydmljZS5kZWxldGUoYXBwb2ludG1lbnQpOwoKICAgIHJlc3BvbnNlLnJlZGlyZWN0KCIvIik7CiAgICByZXR1cm4gcmVzcG9uc2U7CiAgfTsKCiAgLyoqCiAgICogQ29udHJvbGxlciBtZXRob2QgdGhhdCBjcmVhdGVzIGEgbmV3IGFwcG9pbnRtZW50LiBBbHNvLCBzY2hlZHVsZXMgYW4KICAgKiBhcHBvaW50bWVudCByZW1pbmRlciBvbmNlIHRoZSBhY3R1YWwgYXBwb2ludG1lbnQgaXMgcGVyc2lzdGVkIHRvIHRoZSBkYXRhYmFzZS4KICAgKi8KICBwdWJsaWMgVGVtcGxhdGVWaWV3Um91dGUgY3JlYXRlID0gKHJlcXVlc3QsIHJlc3BvbnNlKSAtPiB7CiAgICBGaWVsZFZhbGlkYXRvciB2YWxpZGF0b3IgPQogICAgICAgIG5ldyBGaWVsZFZhbGlkYXRvcihuZXcgU3RyaW5nW10geyJuYW1lIiwgInBob25lTnVtYmVyIiwgImRhdGUiLCAiZGVsdGEiLCAidGltZVpvbmUifSk7CgogICAgaWYgKHZhbGlkYXRvci52YWxpZChyZXF1ZXN0KSkgewogICAgICBTdHJpbmcgbmFtZSA9IHJlcXVlc3QucXVlcnlQYXJhbXMoIm5hbWUiKTsKICAgICAgU3RyaW5nIHBob25lTnVtYmVyID0gcmVxdWVzdC5xdWVyeVBhcmFtcygicGhvbmVOdW1iZXIiKTsKICAgICAgU3RyaW5nIGRhdGUgPSByZXF1ZXN0LnF1ZXJ5UGFyYW1zKCJkYXRlIik7CiAgICAgIGludCBkZWx0YSA9IDA7CiAgICAgIHRyeSB7CiAgICAgICAgZGVsdGEgPSBJbnRlZ2VyLnBhcnNlSW50KHJlcXVlc3QucXVlcnlQYXJhbXMoImRlbHRhIikpOwogICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiSW52YWxpZCBmb3JtYXQgbnVtYmVyIGZvciBhcHBvaW50bWVudCBkZWx0YSIpOwogICAgICB9CiAgICAgIFN0cmluZyB0aW1lWm9uZSA9IHJlcXVlc3QucXVlcnlQYXJhbXMoInRpbWVab25lIik7CgogICAgICBEYXRlVGltZVpvbmUgem9uZSA9IERhdGVUaW1lWm9uZS5mb3JJRCh0aW1lWm9uZSk7CiAgICAgIERhdGVUaW1lWm9uZSB6b25lVVRDID0gRGF0ZVRpbWVab25lLlVUQzsKCiAgICAgIERhdGVUaW1lIGR0OwogICAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdC5mb3JQYXR0ZXJuKCJNTS1kZC15eXl5IGhoOm1tYSIpOwogICAgICBmb3JtYXR0ZXIgPSBmb3JtYXR0ZXIud2l0aFpvbmUoem9uZSk7CiAgICAgIGR0ID0gZm9ybWF0dGVyLnBhcnNlRGF0ZVRpbWUoZGF0ZSk7CiAgICAgIGZvcm1hdHRlciA9IGZvcm1hdHRlci53aXRoWm9uZSh6b25lVVRDKTsKICAgICAgU3RyaW5nIGRhdGVVVEMgPSBkdC50b1N0cmluZyhmb3JtYXR0ZXIpOwoKICAgICAgQXBwb2ludG1lbnQgYXBwb2ludG1lbnQgPSBuZXcgQXBwb2ludG1lbnQobmFtZSwgcGhvbmVOdW1iZXIsIGRlbHRhLCBkYXRlVVRDLCB0aW1lWm9uZSk7CiAgICAgIHNlcnZpY2UuY3JlYXRlKGFwcG9pbnRtZW50KTsKCiAgICAgIHNjaGVkdWxlSm9iKGFwcG9pbnRtZW50KTsKCiAgICAgIHJlc3BvbnNlLnJlZGlyZWN0KCIvIik7CiAgICB9CgogICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CgogICAgbWFwLnB1dCgiem9uZXMiLCB0aW1lWm9uZXMoKSk7CiAgICByZXR1cm4gbmV3IE1vZGVsQW5kVmlldyhtYXAsICJuZXcubXVzdGFjaGUiKTsKICB9OwoKICAvKioKICAgKiBTY2hlZHVsZXMgYSBBcHBvaW50bWVudFNjaGVkdWxlciBpbnN0YW5jZSB0byBiZSBjcmVhdGVkIGFuZCBleGVjdXRlZCBpbiB0aGUgc3BlY2lmaWVkIGZ1dHVyZQogICAqIGRhdGUgY29taW5nIGZyb20gdGhlIGFwcG9pbnRtZW50IGVudGl0eQogICAqIEBwYXJhbSBhcHBvaW50bWVudCBUaGUgbmV3bHkgY3JlYXRlZCBBcHBvaW50bWVudCB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gcGVyc2lzdGVkIHRvIHRoZSBEQi4KICAgKi8KICBwcml2YXRlIHZvaWQgc2NoZWR1bGVKb2IoQXBwb2ludG1lbnQgYXBwb2ludG1lbnQpIHsKICAgIFN0cmluZyBhcHBvaW50bWVudElkID0gYXBwb2ludG1lbnQuZ2V0SWQoKS50b1N0cmluZygpOwoKICAgIERhdGVUaW1lWm9uZSB6b25lID0gRGF0ZVRpbWVab25lLmZvcklEKGFwcG9pbnRtZW50LmdldFRpbWVab25lKCkpOwogICAgRGF0ZVRpbWUgZHQ7CiAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdC5mb3JQYXR0ZXJuKCJNTS1kZC15eXl5IGhoOm1tYSIpOwogICAgZm9ybWF0dGVyID0gZm9ybWF0dGVyLndpdGhab25lKHpvbmUpOwogICAgZHQgPSBmb3JtYXR0ZXIucGFyc2VEYXRlVGltZShhcHBvaW50bWVudC5nZXREYXRlKCkpOwogICAgRGF0ZSBmaW5hbERhdGUgPSBkdC5taW51c01pbnV0ZXMoYXBwb2ludG1lbnQuZ2V0RGVsdGEoKSkudG9EYXRlKCk7CgogICAgSm9iRGV0YWlsIGpvYiA9CiAgICAgICAgbmV3Sm9iKEFwcG9pbnRtZW50U2NoZWR1bGVyLmNsYXNzKS53aXRoSWRlbnRpdHkoIkFwcG9pbnRtZW50X0pfIiArIGFwcG9pbnRtZW50SWQpCiAgICAgICAgICAgIC51c2luZ0pvYkRhdGEoImFwcG9pbnRtZW50SWQiLCBhcHBvaW50bWVudElkKS5idWlsZCgpOwoKICAgIFRyaWdnZXIgdHJpZ2dlciA9CiAgICAgICAgbmV3VHJpZ2dlcigpLndpdGhJZGVudGl0eSgiQXBwb2ludG1lbnRfVF8iICsgYXBwb2ludG1lbnRJZCkuc3RhcnRBdChmaW5hbERhdGUpLmJ1aWxkKCk7CgogICAgdHJ5IHsKICAgICAgc2NoZWR1bGVyLnNjaGVkdWxlSm9iKGpvYiwgdHJpZ2dlcik7CiAgICB9IGNhdGNoIChTY2hlZHVsZXJFeGNlcHRpb24gZSkgewogICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlVuYWJsZSB0byBzY2hlZHVsZSB0aGUgSm9iIik7CiAgICB9CiAgfQoKICBwcml2YXRlIExpc3Q8U3RyaW5nPiB0aW1lWm9uZXMoKSB7CiAgICBUaW1lWm9uZXMgdHogPSBuZXcgVGltZVpvbmVzKCk7CgogICAgcmV0dXJuIHR6LmdldFRpbWVab25lcygpOwogIH0KfQo=</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/util/AppointmentScheduler.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLnV0aWw7CgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwoKaW1wb3J0IG9yZy5hcGFjaGUuaHR0cC5OYW1lVmFsdWVQYWlyOwppbXBvcnQgb3JnLmFwYWNoZS5odHRwLm1lc3NhZ2UuQmFzaWNOYW1lVmFsdWVQYWlyOwppbXBvcnQgb3JnLnF1YXJ0ei5Kb2I7CmltcG9ydCBvcmcucXVhcnR6LkpvYkRhdGFNYXA7CmltcG9ydCBvcmcucXVhcnR6LkpvYkV4ZWN1dGlvbkNvbnRleHQ7CmltcG9ydCBvcmcucXVhcnR6LkpvYkV4ZWN1dGlvbkV4Y2VwdGlvbjsKCmltcG9ydCBjb20udHdpbGlvLlR3aWxpbzsKaW1wb3J0IGNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMubW9kZWxzLkFwcG9pbnRtZW50OwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnRTZXJ2aWNlOwppbXBvcnQgY29tLnR3aWxpby5yZXN0LmFwaS52MjAxMC5hY2NvdW50Lk1lc3NhZ2U7CmltcG9ydCBjb20udHdpbGlvLnR5cGUuUGhvbmVOdW1iZXI7CgpwdWJsaWMgY2xhc3MgQXBwb2ludG1lbnRTY2hlZHVsZXIgaW1wbGVtZW50cyBKb2IgewogIHByaXZhdGUgc3RhdGljIEFwcFNldHVwIGFwcFNldHVwID0gbmV3IEFwcFNldHVwKCk7CgogIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDQ09VTlRfU0lEID0gYXBwU2V0dXAuZ2V0QWNjb3VudFNpZCgpOwogIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFVVEhfVE9LRU4gPSBhcHBTZXR1cC5nZXRBdXRoVG9rZW4oKTsKICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBUV0lMSU9fTlVNQkVSID0gYXBwU2V0dXAuZ2V0VHdpbGlvUGhvbmVOdW1iZXIoKTsKCiAgcHVibGljIEFwcG9pbnRtZW50U2NoZWR1bGVyKCkge30KCiAgcHVibGljIHZvaWQgZXhlY3V0ZShKb2JFeGVjdXRpb25Db250ZXh0IGNvbnRleHQpIHRocm93cyBKb2JFeGVjdXRpb25FeGNlcHRpb24gewogICAgQXBwU2V0dXAgYXBwU2V0dXAgPSBuZXcgQXBwU2V0dXAoKTsKCiAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0gYXBwU2V0dXAuZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKTsKICAgIEFwcG9pbnRtZW50U2VydmljZSBzZXJ2aWNlID0gbmV3IEFwcG9pbnRtZW50U2VydmljZShmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKSk7CgogICAgLy8gSW5pdGlhbGl6ZSB0aGUgVHdpbGlvIGNsaWVudAogICAgVHdpbGlvLmluaXQoQUNDT1VOVF9TSUQsIEFVVEhfVE9LRU4pOwoKICAgIEpvYkRhdGFNYXAgZGF0YU1hcCA9IGNvbnRleHQuZ2V0Sm9iRGV0YWlsKCkuZ2V0Sm9iRGF0YU1hcCgpOwoKICAgIFN0cmluZyBhcHBvaW50bWVudElkID0gZGF0YU1hcC5nZXRTdHJpbmcoImFwcG9pbnRtZW50SWQiKTsKCiAgICBBcHBvaW50bWVudCBhcHBvaW50bWVudCA9IHNlcnZpY2UuZ2V0QXBwb2ludG1lbnQoTG9uZy5wYXJzZUxvbmcoYXBwb2ludG1lbnRJZCwgMTApKTsKICAgIGlmIChhcHBvaW50bWVudCAhPSBudWxsKSB7CiAgICAgIFN0cmluZyBuYW1lID0gYXBwb2ludG1lbnQuZ2V0TmFtZSgpOwogICAgICBTdHJpbmcgcGhvbmVOdW1iZXIgPSBhcHBvaW50bWVudC5nZXRQaG9uZU51bWJlcigpOwogICAgICBTdHJpbmcgZGF0ZSA9IGFwcG9pbnRtZW50LmdldERhdGUoKTsKICAgICAgU3RyaW5nIG1lc3NhZ2VCb2R5ID0gIlJlbWVtYmVyOiAiICsgbmFtZSArICIsIG9uICIgKyBkYXRlICsgIiB5b3UgaGF2ZSBhbiBhcHBvaW50bWVudCEiOwoKICAgICAgLy8gQnVpbGQgYSBmaWx0ZXIgZm9yIHRoZSBNZXNzYWdlTGlzdAogICAgICBMaXN0PE5hbWVWYWx1ZVBhaXI+IHBhcmFtcyA9IG5ldyBBcnJheUxpc3Q8PigpOwogICAgICBwYXJhbXMuYWRkKG5ldyBCYXNpY05hbWVWYWx1ZVBhaXIoIkJvZHkiLCBtZXNzYWdlQm9keSkpOwogICAgICBwYXJhbXMuYWRkKG5ldyBCYXNpY05hbWVWYWx1ZVBhaXIoIlRvIiwgcGhvbmVOdW1iZXIpKTsKICAgICAgcGFyYW1zLmFkZChuZXcgQmFzaWNOYW1lVmFsdWVQYWlyKCJGcm9tIiwgVFdJTElPX05VTUJFUikpOwoKCiAgICAgIE1lc3NhZ2UgbWVzc2FnZSA9IE1lc3NhZ2UKICAgICAgICAgIC5jcmVhdGUobmV3IFBob25lTnVtYmVyKHBob25lTnVtYmVyKSwgbmV3IFBob25lTnVtYmVyKFRXSUxJT19OVU1CRVIpLCBtZXNzYWdlQm9keSkKICAgICAgICAgIC5leGVjdXRlKCk7CgogICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk1lc3NhZ2Ugc2VudCEgTWVzc2FnZSBTSUQ6ICIgKyBtZXNzYWdlLmdldFNpZCgpKTsKICAgIH0KICB9Cn0K</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/appointment-reminders-java" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>